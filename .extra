#!/usr/bin/env bash

# Thanks: https://apple.stackexchange.com/a/231020/64165
function cask-upgrade() {
    (set -x; brew update;)

    (set -x; brew cleanup;)
    (set -x; brew cask cleanup;)

    red=`tput setaf 1`
    green=`tput setaf 2`
    reset=`tput sgr0`

    casks=( $(brew cask list) )

    for cask in ${casks[@]}
    do
        version=$(brew cask info $cask | sed -n "s/$cask:\ \(.*\)/\1/p")
        installed=$(find "/usr/local/Caskroom/$cask" -type d -maxdepth 1 -maxdepth 1 -name "$version")

        if [[ -z $installed ]]; then
            echo "${red}${cask}${reset} requires ${red}update${reset}."
            (set -x; brew cask uninstall $cask --force;)
            (set -x; brew cask install $cask --force;)
        else
            echo "${red}${cask}${reset} is ${green}up-to-date${reset}."
        fi
    done
}

# nvm post-install
export NVM_DIR="$HOME/.nvm"
[ -s "/usr/local/opt/nvm/nvm.sh" ] && . "/usr/local/opt/nvm/nvm.sh"  # This loads nvm
[ -s "/usr/local/opt/nvm/etc/bash_completion.d/nvm" ] && . "/usr/local/opt/nvm/etc/bash_completion.d/nvm"  # This loads nvm bash_completion

function tidal-upgrade(){
    tidal -v
    curl https://get.tidal.sh/unix | bash 
    tidal -v
}
